# LangBot 表情包插件 (EmoticonPlugin)

让大模型学会发表情包，支持多种适配器和发送方式。

## 功能特性

- 支持多种表情包格式：`.gif`、`.png`、`.jpg`、`.jpeg`、`.webp`
- 支持通过本地路径发送表情包（适用于大多数适配器）
- **新增**：支持通过 URL 发送表情包（适用于 Gewechat 等只支持 URL 的适配器）
- 自动向 AI 提示中添加表情包使用说明
- 自动加载表情包目录中的图片
- 支持通过配置文件自定义表情包 URL 前缀

## 安装方法

1. 将插件目录放入 LangBot 的 `plugins` 目录中
2. 重启 LangBot 服务

## 使用方法

### 基本使用

AI 可以在回复中使用 `%表情名%` 格式来发送表情包，例如：

```
我很开心 %愉快%
```

这将发送一条包含"我很开心"文本和"愉快"表情包的消息。

### 添加表情包

1. 将表情包图片放入插件目录下的 `images` 文件夹中
2. 图片文件名（不含扩展名）将作为表情名，例如 `愉快.gif` 的表情名为 `愉快`
3. 重启 LangBot 服务，新的表情包将自动加载

### 配置 URL 发送方式（适用于 Gewechat 等适配器）

对于 Gewechat 等只支持 URL 的适配器，需要设置表情包 URL 前缀：

1. 准备一个 HTTP 服务器托管表情包图片，例如：
   ```bash
   # 使用 Python 的 HTTP 服务器
   python3 -m http.server 8000
   ```

2. 编辑插件目录下的 `config.json` 文件，设置 URL 前缀和使用模式：
   ```json
   {
     "url_prefix": "http://你的服务器IP:端口/images",
     "use_url": true,
     "emoticons": ["愉快", "关心", ...]
   }
   ```

3. 确保表情包图片可以通过 `http://你的服务器IP:端口/images/愉快.gif` 等 URL 访问

4. 重启 LangBot 服务

## 配置选项

在 `config.json` 中可以设置以下选项：

| 选项 | 类型 | 说明 |
|-----|-----|-----|
| `url_prefix` | 字符串 | 表情包图片 URL 前缀，用于构建表情包图片 URL |
| `use_url` | 布尔值 | 是否使用 URL 方式发送表情包，适用于 Gewechat 等只支持 URL 的适配器 |
| `emoticons` | 数组 | 表情包列表，会在加载表情包时自动更新 |

## 适配器兼容性

| 适配器 | 支持方式 | 说明 |
|-------|---------|-----|
| 大多数适配器 | 本地路径 | 使用 `path` 参数发送图片 |
| Gewechat | URL | 使用 `url` 参数发送图片，需要设置 `url_prefix` |

## 常见问题

### 表情包无法发送

- 检查表情包文件是否存在于 `images` 目录中
- 检查表情包文件名是否正确
- 检查表情包文件格式是否支持

### Gewechat 适配器无法发送表情包

- 确保已设置 `url_prefix` 和 `use_url: true`
- 确保表情包图片可以通过 URL 访问
- 检查网络连接和防火墙设置

## 更新日志

### v0.2
- 添加 URL 支持，适用于 Gewechat 等只支持 URL 的适配器
- 添加配置选项，支持自定义表情包 URL 前缀
- 改进错误处理和日志记录

### v0.1
- 初始版本，支持通过本地路径发送表情包

## 贡献者

- 小馄饨 (原作者)
- Jarvis0225 (添加 URL 支持)
